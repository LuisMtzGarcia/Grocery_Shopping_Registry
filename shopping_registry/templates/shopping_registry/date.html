{% extends 'shopping_registry/base.html' %}

{% block page_header %}
<h2>
    Día: {{ date.date_trip|date:"j N Y" }}
</h2>
{% endblock page_header %}

{% block content %}
<p>
    <a href="{% url 'shopping_registry:edit_date' date.id %}">Editar fecha</a>
    -
    <a href="{% url 'shopping_registry:new_purchase' %}">Registra una nueva compra</a>
    -
    <a href="{% url 'shopping_registry:erase_date_confirmation' date.id %}">Eliminar esta fecha</a>
</p>
<p>
    Para editar o eliminar una compra, dale click.
</p>
<p>
    Compras:
</p>
<ul>
    {% for purchase in purchases %}
        <li>
            <a href="{% url 'shopping_registry:edit_purchase' purchase.id %}">
                {{ purchase }}
            </a>
        </li>
    {% empty %}
        <li>
            Aún no se han registrado compras para esta visita. 
            <a href="{% url 'shopping_registry:new_purchase' %}">
                Registra una.
            </a>
        </li>
    {% endfor %}
</ul>
<p>
    Total de la visita: ${{ total }}
</p>
<p>
    {% if bar_graph %}
    <div style="width:600; height:500;">
        {{ bar_graph|safe}}
    </div>
    {% endif %}
</p>
<p>
    Información detallada: 
    <br>
    Para editar algún producto, dale click en su nombre.
    <br>
    Productos con precio por unidad o 100gr:
</p>
<ul>
    {% for key, value in dictionary.items %}
        {% for key2, value2 in value.items %}
            {% if value2 == True %}
                <li>Precio 100 gramos: 
            {% elif value2 == False %}
                <li>Precio por unidad: 
            {% elif value2 > 0 %}
                ${{ value2 }}</li>
                <br>
            {% elif value2 in categories %}
                <li>Categoria: {{ value2 }}</li>
            {% else %}
                <li>
                    Producto: 
                    <a href="{% url 'shopping_registry:edit_product' value2.id %}">
                        {{ value2 }}
                    </a>
                </li>
            {% endif %}
        {% endfor %}
    {% empty %}
        <li>Aún no se han registrado productos.</li>
    {% endfor %}
</ul>
<p>
    Gasto por categoría de productos:
</p>
<ul>
    {% for category, total in category_spent.items %}
        <li>
            Categoría: 
            <a href="{% url 'shopping_registry:edit_category' category.id %}">
                {{ category }}
            </a>
        </li>
        <li>
            Total: ${{ total }}
        </li>
        <br>
    {% empty %}
        <li>
            Aún no se han registrado productos.
        </li>
    {% endfor %}
</ul>
<p>
    {% if pie_graph %}
    <div style="width:600; height:500;">
        {{ pie_graph|safe}}
    </div>
    {% else %}
    <p>
        No graph was provided.
    </p>
    {% endif %}
</p>


{% endblock content %}